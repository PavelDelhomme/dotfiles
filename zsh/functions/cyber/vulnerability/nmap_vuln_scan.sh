# Nouvelle fonction pour effectuer un scan de vulnérabilités avec Nmap
# DESC: Effectue un scan de vulnérabilités avec Nmap en utilisant les scripts NSE pour identifier les failles de sécurité.
# USAGE: nmap_vuln_scan <target>
# EXAMPLE: nmap_vuln_scan 192.168.1.1
function nmap_vuln_scan() {
    # Vérifier et installer nmap si nécessaire
    UTILS_DIR="$HOME/dotfiles/zsh/functions/utils"
    if [ -f "$UTILS_DIR/ensure_tool.sh" ]; then
        source "$UTILS_DIR/ensure_tool.sh"
        ensure_tool nmap || return 1
    fi
    
    if [ $# -eq 0 ]; then
        echo "Usage: nmap_vuln_scan <target>"
        echo "Effectue un scan de vulnérabilités avec Nmap."
        echo "Exemple: nmap_vuln_scan example.com"
        return 1
    fi
    nmap -sV --script vuln $1
}
